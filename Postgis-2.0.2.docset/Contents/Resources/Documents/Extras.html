<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 12. PostGIS Extras</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="PostGIS 2.0.2SVN Manual"><link rel="up" href="index.html" title="PostGIS 2.0.2SVN Manual"><link rel="prev" href="AsGML.html" title="AsGML"><link rel="next" href="Drop_Indexes_Generate_Script.html" title="Drop_Indexes_Generate_Script"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 12. PostGIS Extras</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="AsGML.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="Drop_Indexes_Generate_Script.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="Extras"></a>Chapter 12. PostGIS Extras</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="Extras.html#Tiger_Geocoder">12.1. Tiger Geocoder</a></span></dt></dl></div><p>This chapter documents features found in the extras folder of the PostGIS source tarballs and source repository.  These
  are not always packaged with PostGIS binary releases, but are usually plpgsql based or standard shell scripts that can be run as is.</p><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Tiger_Geocoder"></a>12.1. Tiger Geocoder</h2></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>A plpgsql based geocoder written to work with the <a href="http://www.census.gov/geo/www/tiger/" target="_top">TIGER (Topologically Integrated Geographic Encoding and Referencing system ) / Line and Master Address database export</a> released by the US Census Bureau.  In prior versions the TIGER files were
			released in ASCII format.  The older geocoder used to work with that format is in <code class="varname">extras/tiger_geocoder/tiger_2006andbefore</code>. </p><p>There are four components to the geocoder: the data loader functions, the address normalizer, the address geocoder, and the reverse geocoder. The latest version updated to use the TIGER 2010 census data is located in the <code class="varname">extras/tiger_geocoder/tiger_2010</code> folder.</p><p>Although it is designed specifically for the US, a lot of the concepts and functions are applicable and can be adapted to work with other country address and road networks.</p><p>The script builds a schema called <code class="varname">tiger</code> to house all the tiger related functions, reusable lookup data such as road type prefixes, suffixes, states, various control tables for managing data load, and skeleton base tables from which all the tiger loaded tables inherit from.</p><p>Another schema called <code class="varname">tiger_data</code> is also created which houses all the census data for each state that the loader downloads from Census site and loads into the database. In the current model, each set of state tables is
			    prefixed with the state code e.g ma_addr, ca_edges etc with constraints to enforce only that state data.  Each of these tables inherits from the base addr, faces, edges, etc located in the tiger schema. </p><p>All the geocode functions only reference the base tables, so there is no requirement that the data schema be called <code class="varname">tiger_data</code> or that data can't be further partitioned into other schemas -- e.g a different schema
			for each state, as long as all the tables inherit from the tables in the <code class="varname">tiger</code> schema.</p><p>
			  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
If you are using a prerelease version of PostGIS 2.0.0 tiger geocoder,
you can upgrade the scripts using the accompanying upgrade_geocoder.bat
/ .sh scripts in tiger_2010.  We'll be refining the upgrade scripts
until release.
			  </p></td></tr></table></div><p>
			</p><p>Design:</p><p>The goal of this project is to build a fully functional geocoder that can process an arbitrary 
			address string and using normalized TIGER census data, produce a point geometry and rating reflecting the location of the given address and likeliness of the location.</p><p>The <code class="varname">reverse_geocode</code> function, introduced in PostGIS 2.0.0 is useful for deriving the street address and cross streets of a GPS location.</p><p>The geocoder should be simple for anyone familiar with PostGIS to install and use, and should be easily installable and usable on all platforms supported by PostGIS.</p><p>It should be robust enough to function properly despite formatting and spelling errors.</p><p>It should be extensible enough to be used with future data updates, or alternate data sources with a minimum of coding changes.</p><p>
		</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The <code class="varname">tiger</code> schema must be added to the database search path for the functions to work properly.</p></td></tr></table></div><p>
			</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="Drop_Indexes_Generate_Script.html">Drop_Indexes_Generate_Script</a></span><span class="refpurpose"> - Generates a script that drops all non-primary key and non-unique indexes on tiger schema and user specified schema.  Defaults schema to tiger_data if no schema is specified.</span></dt><dt><span class="refentrytitle"><a href="Drop_State_Tables_Generate_Script.html">Drop_State_Tables_Generate_Script</a></span><span class="refpurpose"> - Generates a script that drops all tables in the specified schema that are prefixed with the state abbreviation.  Defaults schema to tiger_data if no schema is specified.</span></dt><dt><span class="refentrytitle"><a href="Geocode.html">Geocode</a></span><span class="refpurpose"> - Takes in an address as a string (or other normalized address) and outputs a set of possible locations which include a point geometry in NAD 83 long lat, a normalized address for each, and the rating.  The lower the rating the more likely the match.  
			Results are sorted by lowest rating first. Can optionally pass in maximum results, defaults to 10, and restrict_region (defaults to NULL)</span></dt><dt><span class="refentrytitle"><a href="Geocode_Intersection.html">Geocode_Intersection</a></span><span class="refpurpose"> - Takes in 2 streets that intersect and a state, city, zip,  and outputs a set of possible locations on the first cross street that is at the intersection, also includes a point geometry in NAD 83 long lat, a normalized address for each location, and the rating.  The lower the rating the more likely the match.  
			Results are sorted by lowest rating first. Can optionally pass in maximum results, defaults to 10</span></dt><dt><span class="refentrytitle"><a href="Get_Tract.html">Get_Tract</a></span><span class="refpurpose"> - Returns census tract or field from tract table of where the geometry is located. Default to returning short name of tract.</span></dt><dt><span class="refentrytitle"><a href="Install_Missing_Indexes.html">Install_Missing_Indexes</a></span><span class="refpurpose"> - Finds all tables with key columns used in geocoder joins and filter conditions that are missing used indexes on those columns and will add them.</span></dt><dt><span class="refentrytitle"><a href="Loader_Generate_Script.html">Loader_Generate_Script</a></span><span class="refpurpose"> - Generates a shell script for the specified platform for the specified states that will download Tiger data, stage and load into tiger_data schema. Each state script is returned as a separate record. Latest version supports Tiger 2010 structural changes and also loads census tract, block groups, and blocks tables.</span></dt><dt><span class="refentrytitle"><a href="Loader_Generate_Census_Script.html">Loader_Generate_Census_Script</a></span><span class="refpurpose"> - Generates a shell script for the specified platform for the specified states that will download Tiger census state tract, bg, and tabblocks data tables, stage and load into tiger_data schema. Each state script is returned as a separate record.</span></dt><dt><span class="refentrytitle"><a href="Missing_Indexes_Generate_Script.html">Missing_Indexes_Generate_Script</a></span><span class="refpurpose"> - Finds all tables with key columns used in geocoder joins that are missing indexes on those columns and will output the SQL DDL to
		    define the index for those tables.</span></dt><dt><span class="refentrytitle"><a href="Normalize_Address.html">Normalize_Address</a></span><span class="refpurpose"> - Given a textual street address, returns a composite norm_addy type that has road suffix, prefix and type standardized, street, streetname etc. broken into separate fields.  This function 
		will work with just the lookup data packaged with the tiger_geocoder (no need for tiger census data).</span></dt><dt><span class="refentrytitle"><a href="Pprint_Addy.html">Pprint_Addy</a></span><span class="refpurpose"> - Given a norm_addy composite type object, returns a pretty print representation of it. Usually used in conjunction with normalize_address.</span></dt><dt><span class="refentrytitle"><a href="Reverse_Geocode.html">Reverse_Geocode</a></span><span class="refpurpose"> - Takes a geometry point in a known spatial ref sys and returns a record containing an array of theoretically possible addresses and an array of cross streets.  If include_strnum_range = true, includes the street range in the cross streets.</span></dt><dt><span class="refentrytitle"><a href="Topology_Load_Tiger.html">Topology_Load_Tiger</a></span><span class="refpurpose"> - Loads a defined region of tiger data into a PostGIS Topology and transforming the tiger data to spatial reference of the topology
        	and snapping to the precision tolerance of the topology.</span></dt></dl></div><p>There is another geocoder for PostGIS gaining in popularity and more suitable for international use.  It is called <a href="http://wiki.openstreetmap.org/wiki/Nominatim" target="_top">Nominatim</a>
     and uses OpenStreetMap gazeteer formatted data.  It requires osm2pgsql for loading the data, PostgreSQL 8.4+ and PostGIS 1.5+ to function.  It is packaged as a webservice interface and seems designed to be called as a webservice.
     Just like the tiger geocoder, it has both a geocoder and a reverse geocoder component.  From the documentation, it is unclear if it has a pure SQL interface like the tiger geocoder, or if a good deal of the logic is implemented in the web interface.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="AsGML.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="Drop_Indexes_Generate_Script.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">AsGML </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Drop_Indexes_Generate_Script</td></tr></table></div></body></html>
